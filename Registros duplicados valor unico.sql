--Eliminação de registros duplicados quando uma valor não for único.
CREATE TABLE #TESTE (C1 INT, C2 INT, C3 INT )

INSERT INTO #TESTE VALUES(1,1,1)
INSERT INTO #TESTE VALUES(1,1,2)
INSERT INTO #TESTE VALUES(1,1,3)
INSERT INTO #TESTE VALUES(1,1,4)


INSERT INTO #TESTE VALUES(2,1,1)
INSERT INTO #TESTE VALUES(2,1,2)
INSERT INTO #TESTE VALUES(2,1,3)
INSERT INTO #TESTE VALUES(2,1,4)
INSERT INTO #TESTE VALUES(2,1,5)
INSERT INTO #TESTE VALUES(2,1,6)


INSERT INTO #TESTE VALUES(3,1,1)
INSERT INTO #TESTE VALUES(3,1,2)
INSERT INTO #TESTE VALUES(3,1,3)
INSERT INTO #TESTE VALUES(3,1,4)
INSERT INTO #TESTE VALUES(3,1,5)
INSERT INTO #TESTE VALUES(3,1,6)
INSERT INTO #TESTE VALUES(3,1,7)
INSERT INTO #TESTE VALUES(3,1,8)
INSERT INTO #TESTE VALUES(3,1,9)
INSERT INTO #TESTE VALUES(3,1,10)
INSERT INTO #TESTE VALUES(3,1,11)
INSERT INTO #TESTE VALUES(3,1,12)
INSERT INTO #TESTE VALUES(3,1,13)
INSERT INTO #TESTE VALUES(3,1,14)


SELECT T1.C1, T1.C2, T1.C3
FROM #TESTE T1, #TESTE T2
WHERE 	T1.C1 = T2.C1	AND
	T1.C2 = T2.C2
GROUP BY T1.C1, T1.C2, T1.C3
HAVING MAX(T1.C3) <= MAX(T2.C3)/2


SELECT T1.C1, T1.C2, T1.C3
INTO #DEL_REG
FROM #TESTE T1, #TESTE T2
WHERE 	T1.C1 = T2.C1	AND
	T1.C2 = T2.C2
GROUP BY T1.C1, T1.C2, T1.C3
HAVING MAX(T2.C3)/2 < MAX(T1.C3)

DELETE T1
FROM #TESTE T1, #DEL_REG T2
WHERE 	T1.C1 = T2.C1	AND
	T1.C2 = T2.C2	AND
	T1.C3 = T2.C3